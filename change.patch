diff --git a/lib/features/printing/render/preview_pages.dart b/lib/features/printing/render/preview_pages.dart
index 928d393d5a87bdd3f963bd85c21438f9101199d5..abfd2fdf10745a1cc7ca97e03be7ffb1e8854f04 100644
--- a/lib/features/printing/render/preview_pages.dart
+++ b/lib/features/printing/render/preview_pages.dart
@@ -21,84 +21,88 @@ class _ReceiptPreviewPageState extends State<ReceiptPreviewPage> {
   final _boundaryKey = GlobalKey();
   Uint8List? _png;
   bool _busy = false;
   ByteData? _logo;
 
   @override
   void initState() {
     super.initState();
     _loadLogo().then((_) => _render());
   }
 
   Future<void> _loadLogo() async {
     try {
       _logo = await rootBundle.load('assets/images/logo_clinic.png');
     } catch (_) {
       _logo = null;
     }
   }
 
   Future<void> _render() async {
     if (!mounted) return; setState(() => _busy = true);
     try {
       await WidgetsBinding.instance.endOfFrame;
       final obj = _boundaryKey.currentContext?.findRenderObject();
       if (obj is! RenderRepaintBoundary) throw Exception('boundary not found');
-      if (obj.debugNeedsPaint) { await WidgetsBinding.instance.endOfFrame; }
+      while (obj.debugNeedsPaint) {
+        await WidgetsBinding.instance.endOfFrame;
+      }
       final ui.Image image = await obj.toImage(pixelRatio: 2.6);
       final byteData = await image.toByteData(format: ui.ImageByteFormat.png);
       if (!mounted) return; setState(() => _png = byteData!.buffer.asUint8List());
     } catch (e) {
       if (!mounted) return;
       if (kDebugMode) debugPrint('ReceiptPreview render error: $e');
       ScaffoldMessenger.of(context).showSnackBar(const SnackBar(content: Text('เรนเดอร์ใบเสร็จไม่สำเร็จ')));
     } finally {
       if (mounted) setState(() => _busy = false);
     }
   }
 
   @override
   Widget build(BuildContext context) {
     final data = widget.receipt == null
         ? _sampleData()
         : _mapToRenderData(widget.receipt, showNextAppt: widget.showNextAppt, nextAppt: widget.nextAppt);
     return Scaffold(
       appBar: AppBar(title: const Text('พรีวิวใบเสร็จ (80mm)')),
       body: Center(
         child: Stack(
           children: [
             if (_png != null)
               SingleChildScrollView(padding: const EdgeInsets.all(12), child: Image.memory(_png!))
             else if (_busy)
               const Center(child: CircularProgressIndicator())
             else
               const Center(child: Text('ไม่มีภาพ')),
-            Offstage(
-              offstage: true,
-              child: RepaintBoundary(
-                key: _boundaryKey,
-                child: _ReceiptWidget(width: 576, data: data, logoBytes: _logo),
+            IgnorePointer(
+              child: Opacity(
+                opacity: 0.001,
+                child: RepaintBoundary(
+                  key: _boundaryKey,
+                  child: _ReceiptWidget(width: 576, data: data, logoBytes: _logo),
+                ),
               ),
             ),
           ],
         ),
       ),
       bottomNavigationBar: SafeArea(
         child: Padding(
           padding: const EdgeInsets.all(12),
           child: Row(
             children: [
               Expanded(
                 child: ElevatedButton.icon(
                   onPressed: _busy ? null : _render,
                   icon: const Icon(Icons.refresh),
                   label: const Text('เรนเดอร์ใหม่'),
                 ),
               ),
               const SizedBox(width: 12),
               Expanded(
                 child: ElevatedButton.icon(
                   onPressed: (_png == null || _busy) ? null : _sendToPrinter,
                   icon: const Icon(Icons.print),
                   label: const Text('พิมพ์'),
                 ),
               ),
